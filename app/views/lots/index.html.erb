<div class="box box-solid box-info">
  <%= render 'shared/box_header', described: :lots %>
  <%= render 'shared/box_table', described: :lots %>
</div>

<div class="tableFooter">
  <%= link_to "#{fa_icon 'tags'} New Lot".html_safe, '#', data: { toggle: 'modal', target: '.new-lot' },
      class: 'btn btn-flat btn-info' %>
  <div id="paginator">
    <%= paginate lots, remote: true %>
  </div>
</div>

<% lots.each do |lot| %>
<div class="modal fade" id="<%= lot.id %>" tabindex="-1" role="dialog" aria-labelledby="Containers" aria-hidden="true">
  <div class="modal-dialog modal-sm">
    <div class="modal-content">
      <h3>Containers for <%= link_to "#{fa_icon('tags')} #{lot}".html_safe, lot, class: "btn btn-flat btn-info" %></h3>
        <table class="table table-hover">
          <tr>
            <th>Name :</th>
            <th>Weight :</th>
            <th>Category :</th>
            <th>Actions :</th>
          </tr>

          <% lot.containers.each do |container| %>
          <tr>
            <td><%= link_to container.try(:to_s), container if container.present? %></td>
            <td><%= weight_for container.try(:current_weight) if container.present? %></td>
            <td><%= category_for container.try(:category) if container.present? %></td>
            <td> 
              <% if can? :create, Lot %>
                <%= link_to "New Bag".html_safe, '#', class: 'btn-sm btn-flat btn-danger',
                  data: { toggle: 'modal', target: '.new-bag' } %>
              <% end %>
            </td> 
          </tr>
          <% end %>
        </table>
    </div>
  </div>
</div>
<% end %>

<div class="modal fade new-bag" tabindex="-1" role="dialog" aria-labelledby="New Bag" aria-hidden="true">
  <div class="modal-dialog modal-sm">
    <div class="modal-content">
      <h3>Create a new bag</h3>
      <%= render 'bags/form' %>
    </div>
  </div>
</div>

<div class="modal fade new-lot" tabindex="-1" role="dialog" aria-labelledby="New Lot" aria-hidden="true">
  <div class="modal-dialog modal-sm">
    <div class="modal-content">
      <h3>Create a new lot</h3>
      <%= render 'lots/form' %>
    </div>
  </div>
</div>